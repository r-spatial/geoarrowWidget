<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Attach Geoarrow Data to a Widget • geoarrowWidget</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Attach Geoarrow Data to a Widget">
<meta name="description" content="Provides functions and necessary JavaScript bindings to quickly transfer geospatial data from R memory to the browser for e.g. interactive visualisation.">
<meta property="og:description" content="Provides functions and necessary JavaScript bindings to quickly transfer geospatial data from R memory to the browser for e.g. interactive visualisation.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">geoarrowWidget</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9021</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/use_existing_widget.html">Use geoarrowWidget with an existing widget</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/geoarrowWidget/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level2">
<h2 id="geoarrowwidget">geoarrowWidget<a class="anchor" aria-label="anchor" href="#geoarrowwidget"></a>
</h2>
<p>The aim of <code>geoarrowWidget</code> is to facilitate fast transfer of geospatial data between R memory and the browser using <code>geoarrow</code> memory layout. It provides functionality to attach <code>geoarrow</code> data to existing <code>htmlwidgets</code> along with the relevant JavaScript libraries to handle this data in the browser context. It does not do anything useful beyond the data transfer. It is up to the user/devloper to make further use of this data, e.g. render it somehow, using JavaScript.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Not on CRAN yet, so install from github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"r-spatial/geoarrowWidget"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage-example">Usage example<a class="anchor" aria-label="anchor" href="#usage-example"></a>
</h2>
<p>For testing purposes, <code>geoarrowWidget</code> provides a minimal <code>htmlwidget</code> called <code>geoarrowDummyWidget</code>. Here’s an example of how to use it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/geoarrowWidget" class="external-link">geoarrowWidget</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/wk/" class="external-link">wk</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arrow.apache.org/nanoarrow/latest/r/" class="external-link">nanoarrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://geoarrow.org/geoarrow-r/" class="external-link">geoarrow</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### generate some random sf points data ========================================</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">1e5</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span></span>
<span>  , geometry <span class="op">=</span> <span class="fu"><a href="https://paleolimbot.github.io/wk/reference/xy.html" class="external-link">xy</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">160</span>, <span class="fl">160</span><span class="op">)</span></span>
<span>    , y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">40</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>    , crs <span class="op">=</span> <span class="fl">4326</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">### setup and write to tempfile as geoarrow ====================================</span></span>
<span><span class="va">fl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="va">fl</span></span>
<span>  , <span class="st">"test.arrow"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">interleaved</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="va">data_stream</span> <span class="op">=</span> <span class="fu">nanoarrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/nanoarrow/latest/r/reference/as_nanoarrow_array_stream.html" class="external-link">as_nanoarrow_array_stream</a></span><span class="op">(</span></span>
<span>  <span class="va">dat</span></span>
<span>  , geometry_schema <span class="op">=</span> <span class="fu">geoarrow</span><span class="fu">::</span><span class="fu"><a href="https://geoarrow.org/geoarrow-r/reference/infer_geoarrow_schema.html" class="external-link">infer_geoarrow_schema</a></span><span class="op">(</span></span>
<span>    <span class="va">dat</span></span>
<span>    , coord_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">interleaved</span>, <span class="st">"INTERLEAVED"</span>, <span class="st">"SEPARATE"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nanoarrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/nanoarrow/latest/r/reference/read_nanoarrow.html" class="external-link">write_nanoarrow</a></span><span class="op">(</span><span class="va">data_stream</span>, <span class="va">path</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### create widget and check browser console ====================================</span></span>
<span><span class="va">wgt</span> <span class="op">=</span> <span class="fu"><a href="reference/geoarrowDummyWidget.html">geoarrowDummyWidget</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>viewer <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wgt</span></span></code></pre></div>
<p>This will create a web page with the data attached as a geoarrow object. In the browser console (press F12) this will look something like this (depending on the browser obviously, Librewolf in this case). You should see two entries:</p>
<ol style="list-style-type: decimal">
<li>
<code>Object</code> - the geoarrow data</li>
<li>
<code>PerformanceResourceTiming</code> - details about the performance of loading the data including <code>encodedBodySize</code> of the data in Bytes and <code>duration</code> in milliseconds.</li>
</ol>
<p>Another way to see how long it takes to load the data is to open the <code>Network</code> tab in the developer tools and refresh the page.</p>
<p><img src="reference/figures/browser_console.png"><em>Note: the 200MB <code>encodedBodySize</code> and 375ms <code>duration</code> in the screenshot are the result of running the above code with <code>1e7</code> points.</em></p>
<p><br></p>
<p>The page source (press &lt;CTRL + u&gt;) will look something like this, where in line 11 you see the attached test.arrow file and above the necessary scripts (arrow and geoarrow JS bindings) to process the data further in JavaScript.</p>
<p><img src="reference/figures/browser_source.png"></p>
<p><br></p>
<p>The general usage pattern is highlighted in <a href="https://github.com/r-spatial/geoarrowWidget/blob/master/inst/htmlwidgets/geoarrowDummyWidget.js#L33-L42" class="external-link">these lines of <code>geoarrowDummyWidget</code></a></p>
<div class="section level3">
<h3 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h3>
<p>This project has been realized with financial <a href="https://r-consortium.org/all-projects/funded-projects.html" class="external-link">support</a> from the</p>
<p><a href="https://r-consortium.org/all-projects/funded-projects.html" class="external-link"> <img src="https://r-consortium.org/images/RConsortium_Horizontal_Pantone.webp" width="400"></a></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/r-spatial/geoarrowWidget/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/r-spatial/geoarrowWidget/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing geoarrowWidget</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tim Appelhans <br><small class="roles"> Maintainer, author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/r-spatial/geoarrowWidget/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/r-spatial/geoarrowWidget/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tim Appelhans.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
